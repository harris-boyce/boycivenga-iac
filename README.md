# boycivenga-iac
Terraform repository for managing all things home networking, lab, smart home automations, etc.

## Repository Layout

This repository is organized into the following top-level directories:

- **`netbox-client/`** – Tools and scripts for interacting with the NetBox API and managing network intent data
- **`terraform/`** – Terraform modules and configurations for infrastructure as code
- **`artifacts/`** – Rendered outputs and generated files (used for local development, not version controlled)
- **`scripts/`** – Utility scripts for bootstrap, maintenance, and development workflows
- **`docs/`** – Project documentation, architecture decisions, and operational guides
- **`.github/workflows/`** – CI/CD workflows including the automated render pipeline

## Automated Render Pipeline

This repository includes an automated [render pipeline](docs/render-pipeline.md) that:
- Exports data from the NetBox API
- Generates Terraform tfvars and UniFi configuration files
- Publishes artifacts for review and manual deployment
- **Attests all artifacts** with SLSA provenance for supply chain security

**Important:** The render pipeline is read-only and does not apply infrastructure changes. See [docs/render-pipeline.md](docs/render-pipeline.md) for details.

## Artifact Attestation & Trust Boundary

All artifacts generated by the render pipeline are cryptographically attested using SLSA provenance. This provides:
- **Provenance verification**: Proof that artifacts originate from trusted CI/CD workflows
- **Integrity protection**: Assurance that artifacts have not been tampered with
- **Supply chain security**: Protection against unauthorized modifications

**Trust Boundary Contract**: **Terraform must only consume attested artifacts**. This requirement ensures that all infrastructure deployments are traceable to verified sources. See [docs/phase3/terraform-boundary.md](docs/phase3/terraform-boundary.md) for complete details.

**Note**: Terraform plan/apply operations are not yet implemented. This is a documentation-only requirement for Phase 3.

## Quick Start

### For Contributors

If you're contributing to this repository, please see [CONTRIBUTING.md](CONTRIBUTING.md) for detailed setup instructions and development guidelines.

**Quick setup:**
1. Use the devcontainer (recommended) - all tools are pre-installed, or
2. Run `bash scripts/bootstrap.sh` for manual setup
3. Run `pre-commit install` to enable code quality checks

## Development Environment

This repository includes a development container (devcontainer) configuration that provides a consistent, reproducible development environment for all contributors. The devcontainer comes pre-configured with all necessary tools for working with Terraform, Python, and networking workflows.

### Using the Devcontainer

#### Option 1: Visual Studio Code (Local)

1. **Prerequisites:**
   - Install [Visual Studio Code](https://code.visualstudio.com/)
   - Install the [Dev Containers extension](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers)
   - Install [Docker Desktop](https://www.docker.com/products/docker-desktop)

2. **Open the project in a devcontainer:**
   - Open this repository in VS Code
   - When prompted, click "Reopen in Container" (or run the command `Dev Containers: Reopen in Container` from the Command Palette)
   - VS Code will build the container and open a new window connected to it

3. **Rebuild the container (if needed):**
   - Run the command `Dev Containers: Rebuild Container` from the Command Palette

#### Option 2: GitHub Codespaces (Cloud)

1. **Create a Codespace:**
   - Navigate to the repository on GitHub
   - Click the "Code" button, then select the "Codespaces" tab
   - Click "Create codespace on [branch]"
   - GitHub will create and configure your cloud development environment

2. **Access your Codespace:**
   - Your Codespace will open in a browser-based VS Code instance
   - Alternatively, you can connect to it from VS Code Desktop

### What's Included

The devcontainer provides:

- **Base:** Ubuntu Linux environment
- **Tools:**
  - Terraform (latest version)
  - Python 3 (latest version) with pip
  - Docker CLI and Docker Compose (with Docker-in-Docker support)
  - GitHub CLI
  - pre-commit (automatically installed on container creation)
- **VS Code Extensions:**
  - Python (`ms-python.python`)
  - Terraform (`hashicorp.terraform`)
  - YAML (`redhat.vscode-yaml`)
  - Markdown All in One (`yzhang.markdown-all-in-one`)

### Network Connectivity

The devcontainer is configured to support network connectivity for:
- Local NetBox/UniFi endpoints
- Remote NetBox/UniFi endpoints
- Docker Compose services for testing

### Customization

The devcontainer can be extended with additional tools:

1. **Add development tools:** Edit `.devcontainer/Dockerfile` to install additional packages
2. **Add VS Code extensions:** Edit the `customizations.vscode.extensions` array in `.devcontainer/devcontainer.json`
3. **Add devcontainer features:** Edit the `features` object in `.devcontainer/devcontainer.json` (see [available features](https://containers.dev/features))

Example: Adding UniFi CLI or additional linters:

```dockerfile
# In .devcontainer/Dockerfile
RUN apt-get update \
    && apt-get install -y --no-install-recommends \
      your-additional-tool \
    && rm -rf /var/lib/apt/lists/*
```
